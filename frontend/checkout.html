<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Secure Checkout</title>
    <link rel="stylesheet" href="css/theme.css">
    <link rel="stylesheet" href="css/checkout.css">
</head>
<body>

<header class="topbar">
    <h1>Secure Checkout</h1>
    <a href="cart.html" class="logout">Cancel</a>
</header>

<main class="checkout-container">

    <div class="checkout-card">
        
        <div class="card-preview">
            <div class="chip"></div>
            <div class="logo">Visa</div>
            <div class="card-number-display" id="display-number">#### #### #### ####</div>
            <div class="card-details">
                <div class="card-holder-display" id="display-name">YOUR NAME</div>
                <div class="card-expiry-display" id="display-expiry">MM/YY</div>
            </div>
        </div>

        <h2 style="margin-top: 20px;">Payment Details</h2>
        <p class="subtitle">Complete your purchase of <strong>$120.00</strong></p>

        <form action="order-success.html">
            
            <div class="input-group">
                <label>Card Number</label>
                <input type="text" id="card-number" placeholder="0000 0000 0000 0000" 
                       maxlength="19" required
                       oninput="formatCardNumber(this)">
            </div>

            <div class="input-group">
                <label>Cardholder Name</label>
                <input type="text" id="card-name" placeholder="JOHN DOE" required 
                       oninput="formatCardName(this)">
            </div>

            <div class="row">
                <div class="input-group">
                    <label>Expiry Date</label>
                    <input type="text" id="card-expiry" placeholder="MM/YY" maxlength="5" required
                           oninput="formatExpiry(this)">
                </div>
                
                <div class="input-group">
                    <label>CVV</label>
                    <input type="password" placeholder="123" maxlength="3" required 
                           oninput="formatCVV(this)"
                           style="letter-spacing: 3px;">
                </div>
            </div>

            <button type="submit" class="action-btn">Pay $120.00</button>
        </form>

        <p class="secure-text">ðŸ”’ Payments are secure and encrypted.</p>
    </div>

</main>

<script>
    // 1. Format Card Number
    function formatCardNumber(input) {
        let value = input.value.replace(/\D/g, ''); // Remove non-digits
        value = value.substring(0, 16); // Limit to 16 digits
        let formatted = value.match(/.{1,4}/g)?.join(' ') || value;
        input.value = formatted;
        document.getElementById('display-number').innerText = formatted || '#### #### #### ####';
    }

    // 2. Format Expiry Date (MM/YY) - FIXED
    function formatExpiry(input) {
        // Remove non-digits
        let value = input.value.replace(/\D/g, '');
        
        // Month Validation (Cannot be > 12)
        if (value.length >= 2) {
            let month = parseInt(value.substring(0, 2));
            if (month > 12) {
                value = '12' + value.substring(2); // Force month to 12 if user types higher
            } else if (month === 0) {
                value = '01' + value.substring(2); // Force 00 to 01
            }
        }

        // Add Slash
        if (value.length >= 2) {
            value = value.substring(0,2) + '/' + value.substring(2,4);
        }

        input.value = value;
        document.getElementById('display-expiry').innerText = value || 'MM/YY';
    }

    // 3. Format Card Name (Letters Only) - FIXED
    function formatCardName(input) {
        // Regex replace: Replace anything that is NOT a letter (a-z) or space with empty string
        input.value = input.value.replace(/[^a-zA-Z\s]/g, '');
        document.getElementById('display-name').innerText = input.value.toUpperCase() || 'YOUR NAME';
    }

    // 4. Format CVV (Numbers Only) - FIXED
    function formatCVV(input) {
        // Remove anything that is not a number
        input.value = input.value.replace(/\D/g, '');
    }
</script>

</body>
</html>